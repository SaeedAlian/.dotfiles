#!/usr/bin/env bash
set -e

load_all_colors

require_vars \
  COLOR_BG \
  COLOR_FG \
  COLOR_RED \
  COLOR_GREEN \
  COLOR_YELLOW \
  COLOR_BLUE \
  COLOR_MAGENTA \
  COLOR_CYAN \
  COLOR_GRAY \
  XRESOURCES_COLOR_BG \
  XRESOURCES_COLOR_FG \
  XRESOURCES_COLOR_RED \
  XRESOURCES_COLOR_GREEN \
  XRESOURCES_COLOR_YELLOW \
  XRESOURCES_COLOR_BLUE \
  XRESOURCES_COLOR_MAGENTA \
  XRESOURCES_COLOR_CYAN \
  XRESOURCES_COLOR_GRAY \
  ALACRITTY_COLOR_BG \
  ALACRITTY_COLOR_FG \
  ALACRITTY_COLOR_BRIGHT_FG \
  ALACRITTY_COLOR_DIM_FG \
  ALACRITTY_COLOR_NORMAL_BLACK \
  ALACRITTY_COLOR_NORMAL_RED \
  ALACRITTY_COLOR_NORMAL_GREEN \
  ALACRITTY_COLOR_NORMAL_YELLOW \
  ALACRITTY_COLOR_NORMAL_BLUE \
  ALACRITTY_COLOR_NORMAL_MAGENTA \
  ALACRITTY_COLOR_NORMAL_CYAN \
  ALACRITTY_COLOR_NORMAL_WHITE \
  ALACRITTY_COLOR_BRIGHT_BLACK \
  ALACRITTY_COLOR_BRIGHT_RED \
  ALACRITTY_COLOR_BRIGHT_GREEN \
  ALACRITTY_COLOR_BRIGHT_YELLOW \
  ALACRITTY_COLOR_BRIGHT_BLUE \
  ALACRITTY_COLOR_BRIGHT_MAGENTA \
  ALACRITTY_COLOR_BRIGHT_CYAN \
  ALACRITTY_COLOR_BRIGHT_WHITE \
  ALACRITTY_COLOR_DIM_BLACK \
  ALACRITTY_COLOR_DIM_RED \
  ALACRITTY_COLOR_DIM_GREEN \
  ALACRITTY_COLOR_DIM_YELLOW \
  ALACRITTY_COLOR_DIM_BLUE \
  ALACRITTY_COLOR_DIM_MAGENTA \
  ALACRITTY_COLOR_DIM_CYAN \
  ALACRITTY_COLOR_DIM_WHITE \
  ALACRITTY_COLOR_SEARCH_MATCHES_BG \
  ALACRITTY_COLOR_SEARCH_MATCHES_FG \
  ALACRITTY_COLOR_SEARCH_FOCUSED_MATCH_BG \
  ALACRITTY_COLOR_SEARCH_FOCUSED_MATCH_FG \
  ALACRITTY_COLOR_SELECTION_BG \
  ALACRITTY_COLOR_SELECTION_TEXT \
  ALACRITTY_COLOR_HINTS_START_BG \
  ALACRITTY_COLOR_HINTS_START_FG \
  ALACRITTY_COLOR_HINTS_END_BG \
  ALACRITTY_COLOR_HINTS_END_FG \
  BSPWM_COLOR_BORDER_NORMAL \
  BSPWM_COLOR_BORDER_FOCUSED \
  DUNST_COLOR_FRAME \
  DUNST_COLOR_URG_LOW_BG \
  DUNST_COLOR_URG_LOW_FG \
  DUNST_COLOR_URG_NORMAL_BG \
  DUNST_COLOR_URG_NORMAL_FG \
  DUNST_COLOR_URG_CRIT_BG \
  DUNST_COLOR_URG_CRIT_FG \
  DUNST_COLOR_URG_CRIT_FRAME \
  BAR_COLOR_BG \
  BAR_COLOR_BG_ALT \
  BAR_COLOR_FG \
  BAR_COLOR_FG_DIM \
  BAR_COLOR_SEP \
  BAR_COLOR_DISABLED \
  BAR_COLOR_BORDER \
  BAR_COLOR_RED \
  BAR_COLOR_GREEN \
  BAR_COLOR_YELLOW \
  BAR_COLOR_BLUE \
  BAR_COLOR_MAGENTA \
  BAR_COLOR_CYAN \
  BAR_COLOR_GRAY \
  NVIM_COLOR_STATUS_LINE_NORMAL_BG \
  NVIM_COLOR_STATUS_LINE_NORMAL_FG \
  NVIM_COLOR_STATUS_LINE_INSERT_BG \
  NVIM_COLOR_STATUS_LINE_INSERT_FG \
  NVIM_COLOR_STATUS_LINE_VISUAL_BG \
  NVIM_COLOR_STATUS_LINE_VISUAL_FG \
  NVIM_COLOR_STATUS_LINE_VISUAL_LINE_BG \
  NVIM_COLOR_STATUS_LINE_VISUAL_LINE_FG \
  NVIM_COLOR_STATUS_LINE_VISUAL_BLOCK_BG \
  NVIM_COLOR_STATUS_LINE_VISUAL_BLOCK_FG \
  NVIM_COLOR_STATUS_LINE_COMMAND_BG \
  NVIM_COLOR_STATUS_LINE_COMMAND_FG \
  NVIM_COLOR_STATUS_LINE_REPLACE_BG \
  NVIM_COLOR_STATUS_LINE_REPLACE_FG \
  NVIM_COLOR_STATUS_LINE_TERMINAL_BG \
  NVIM_COLOR_STATUS_LINE_TERMINAL_FG \
  NVIM_COLOR_STATUS_LINE_DIM_BG \
  NVIM_COLOR_STATUS_LINE_DIM_FG \
  ROFI_COLOR_BG_NORM \
  ROFI_COLOR_BG_SEL \
  ROFI_COLOR_BG_LABEL \
  ROFI_COLOR_BORDER \
  ROFI_COLOR_FG_NORM \
  ROFI_COLOR_FG_SEL \
  ROFI_COLOR_FG_LABEL \
  ZATHURA_COLOR_BG \
  ZATHURA_COLOR_FG \
  ZATHURA_COLOR_STATUS_BAR_BG \
  ZATHURA_COLOR_STATUS_BAR_FG \
  ZATHURA_COLOR_INPUT_BAR_BG \
  ZATHURA_COLOR_INPUT_BAR_FG \
  ZATHURA_COLOR_NOTIF_ERR_BG \
  ZATHURA_COLOR_NOTIF_ERR_FG \
  ZATHURA_COLOR_NOTIF_WARN_BG \
  ZATHURA_COLOR_NOTIF_WARN_FG \
  ZATHURA_COLOR_COMPLETION_BG \
  ZATHURA_COLOR_COMPLETION_FG \
  ZATHURA_COLOR_NOTIF_BG \
  ZATHURA_COLOR_NOTIF_FG \
  ZATHURA_COLOR_RECOLOR_LIGHT \
  ZATHURA_COLOR_RECOLOR_DARK \
  DOTFILES_DIR \
  XDG_CONFIG_HOME \
  SCRIPTS_DIR

# xresources
envsubst <$DOTFILES_DIR/X11/.config/X11/Xresources.in \
  >$DOTFILES_DIR/X11/.config/X11/Xresources
xrdb $XDG_CONFIG_HOME/X11/Xresources &

# alacritty
envsubst <$DOTFILES_DIR/alacritty/.config/alacritty/colors.toml.in \
  >$DOTFILES_DIR/alacritty/.config/alacritty/colors.toml

# dunst
envsubst <$DOTFILES_DIR/dunst/.config/dunst/dunstrc.in \
  >$DOTFILES_DIR/dunst/.config/dunst/dunstrc
pgrep -x dunst >/dev/null && pkill dunst

# bar
envsubst <$DOTFILES_DIR/polybar/.config/polybar/colors.ini.in \
  >$DOTFILES_DIR/polybar/.config/polybar/colors.ini

# nvim
envsubst <$DOTFILES_DIR/nvim/.config/nvim/lua/core/colors.lua.in \
  >$DOTFILES_DIR/nvim/.config/nvim/lua/core/colors.lua

# rofi
envsubst <$DOTFILES_DIR/rofi/.config/rofi/colors.rasi.in \
  >$DOTFILES_DIR/rofi/.config/rofi/colors.rasi

# zathura
envsubst <$DOTFILES_DIR/zathura/.config/zathura/colors.conf.in \
  >$DOTFILES_DIR/zathura/.config/zathura/colors.conf

# bspwm
bspc wm -r
